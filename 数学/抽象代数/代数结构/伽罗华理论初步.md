## 对称多项式与韦达定理

对于 $n$ 元多项式 $f(x_1,x_2,\cdots,x_n)$，若任意交换 $x_1,x_2,\cdots,x_n$ 的位置，  
$f(x_1,x_2,\cdots,x_n)$ 不改变，则称 $f$ 为关于 $x_1,x_2,\cdots,x_n$ 的**对称多项式**。

易发现，对称多项式的每一个单项式等价类相当于将 $n$ 个相同的球  
放进无数个盒子里的一个方案。

根据因式分解与一元 $n$ 次方程的关系，  
对于一元 $n$ 次方程 $x^n+p_1x+p_2x+\cdots+p_n=0$  
的解 $x_1,x_2,\cdots,x_n$，有韦达定理

$$
\begin{cases}
	\displaystyle\sum_{1\le a_1\le n} x_{a_1}=-p_1  \\
	\displaystyle\sum_{1\le a_1<a_2\le n} x_{a_1}x_{a_2}=p_2\\
	\displaystyle\sum_{1\le a_1<a_2<a_3\le n} x_{a_1}x_{a_2}x_{a_3}=-p_3\\
	\cdots\\
	\displaystyle x_1x_2\cdots x_n=(-1)^np_n
\end{cases}
$$
易发现，等式的左边都是关于 $x_1,x_2,\cdots,x_n$ 的对称多项式，  
它们被称为**初等对称多项式**，记为 $\sigma_1,\sigma_2,\cdots,\sigma_n$。

### 性质
- 若干对称多项式之积的线性组合仍是对称多项式。（显然）
- 对称多项式基本定理：  
  任意对称多项式都能唯一分解为若干初等对称多项式之积的线性组合。  
  证明：对于 $n$ 元对称多项式 $f$，将其所有单项式等价类排序    
	（先按各元总次数从大到小排序，相同则按最大次数从大到小排序，  
	  又相同则按次大次数从大到小排序...以此类推）

  设其排序后第一个单项式等价类为 
	$$a\sum_{p}\prod_k x_{p_k}^{l_k}\quad(l_1\le l_2\le\cdots\le l_n)$$
	设 $l_0=0$，显然其等于
	$$a\sum_{p}\prod_{k}\left(\prod_{i=1}^k x_{p_k}\right)^{l_k-l_{k-1}}$$
    于是构造对称多项式 $a\prod_k\sigma_k^{l_k-l_{k-1}}$，显然其排序后第一个单项式等价类与 $f$ 相同  
	（乘 $\sigma_k$ 相当于任选 $k$ 个球移动到下一个盒子里，贪心可唯一确定序最大的方案）  
	将 $f$ 减去 $a\prod_k\sigma_k^{l_k-l_{k-1}}$，其最靠前的单项式等价类的序减小。  
	机械重复该过程，即可把 $f$ 唯一分解为初等对称多项式之积的线性组合。

## 预解式与辅助方程

对于一元 $n$ 次方程 $x^n+p_1x^{n-1}+p_2x^{n-2}+\cdots+p_n=0$ 的 $n$ 个根 $x_1,x_2,\cdots,x_n$，  
定义**预解式**为 $n$ 元置换到 $x_1,x_2,\cdots,x_n$ 线性组合的函数

$$u(\tau)=c_1x_{\tau_1}+c_2x_{\tau_2}+\cdots+c_nx_{\tau_n}$$

预解式有如下性质：

对于所有的 $n$ 元置换 $\tau_1,\tau_2,\cdots,\tau_{n!}$，  
关于 $u(\tau_1),u(\tau_2),\cdots,u(\tau_{n!})$ 的对称多项式同时也是关于 $x_1,x_2,\cdots,x_n$ 的对称多项式。

在此基础上，定义**辅助方程**为关于 $y$ 的方程

$$(y-u(\tau_1))(y-u(\tau_2))\cdots(y-u(\tau_{n!}))=0$$

根据韦达定理，该方程的系数为关于 $u(\tau_1),u(\tau_2),\cdots,u(\tau_{n!})$ 的基本对称多项式，  
也就同时是关于 $x_1,x_2,\cdots,x_n$ 的对称多项式，可以用 关于 $x_1,x_2,\cdots,x_n$ 的  
初等对称多项式，即原方程的系数 $p_1,p_2,\cdots,p_n$ 机械地唯一表示出来。

求出辅助方程的解，联立线性方程组

$$
\begin{bmatrix}
	c_{\tau_{1,1}}& c_{\tau_{1,2}}&\cdots& c_{\tau_{1,n}}\\
	c_{\tau_{2,1}}& c_{\tau_{2,2}}&\cdots& c_{\tau_{2,n}}\\
	\vdots&\vdots&\vdots&\vdots\\
	c_{\tau_{n!,1}}& c_{\tau_{n!,2}}&\cdots& c_{\tau_{n!,n}}\\
	1&1&\cdots&1
\end{bmatrix}\begin{bmatrix}
	x_1\\x_2\\ \vdots\\x_n
\end{bmatrix}=\begin{bmatrix}y_1\\y_2\\ \vdots\\y_{n!}\\ p_1\end{bmatrix}
$$

即可求出原方程的解。

辅助方程的次数看似很大，但根据线性代数知识可知，  
$u(\tau)$ 张成的线性空间维度最多为 $n$，  
为了实现降次，同时因为只有一个额外的方程组 $(x_1+x_2+\cdots+x_n=p_1)$ 与解联立，  
我们需要辅助方程**实际上**刚好是个 $n-1$ 次方程，这借助于预解式的合理选择。

## 二次、三次、四次方程解法

### 二次方程解法
对于一元二次方程

$$x^2-ax+b=0$$

其有两个根 $x_1,x_2$，满足韦达定理

$$\begin{cases}
	x_1+x_2=a\\
	x_1x_2=b
\end{cases}$$

设其预解式 $u(\tau)=x_{\tau_1}-x_{\tau_2}$，其有两个不同的取值

$$u\begin{pmatrix}1 &2\\1 &2\end{pmatrix}=x_1-x_2=p,\\
u\begin{pmatrix}1 &2\\2 &1\end{pmatrix}=x_2-x_1=-p$$

定义辅助方程

$$(y+p)(y-p)=0$$

显然

$$y^2-p^2=0$$

也就是说辅助方程实际上是个一次方程。我们可以将 $p^2$ 唯一分解为 $x_1,x_2$ 的初等对称多项式

$$p^2=(x_1-x_2)^2=(x_1+x_2)^2-4x_1x_2$$

代入 $p^2=a^2-4b$ 即可解出

$$y=a^2-4b$$

联立线性方程组

$$\begin{bmatrix}1&-1\\1&1\end{bmatrix}{x_1\brack x_2}={\sqrt{a^2-4b}\brack a}$$

即可解出 $x_1=\dfrac{-a+\sqrt{a^2-4b}}{2},x_2=\dfrac{-a-\sqrt{a^2-4b}}{2}$

### 三次方程解法

对于一元三次方程

$$x^3-ax^2+bx-c=0$$

其有三个根 $x_1,x_2,x_3$，满足韦达定理

$$\begin{cases}
	x_1+x_2+x_3=a\\
	x_1x_2+x_1x_3+x_2x_3=b\\
	x_1x_2x_3=c
\end{cases}$$
设其预解式 $u(\tau)=x_{\tau_1}+\omega x_{\tau_2}+\omega^2x_{\tau_3},\omega$ 为三次单位根，其有六个不同的取值

$$
u\begin{pmatrix}1&2&3\\1&2&3\end{pmatrix}=x_1+\omega x_2+\omega^2 x_3=p\\
u\begin{pmatrix}1&2&3\\3&1&2\end{pmatrix}=x_3+\omega x_1+\omega^2 x_2=\omega p\\
u\begin{pmatrix}1&2&3\\2&3&1\end{pmatrix}=x_2+\omega x_3+\omega^2 x_1=\omega^2 p\\
u\begin{pmatrix}1&2&3\\1&3&2\end{pmatrix}=x_1+\omega x_3+\omega^2 x_2=q\\
u\begin{pmatrix}1&2&3\\2&1&3\end{pmatrix}=x_2+\omega x_1+\omega^2 x_3=\omega q\\
u\begin{pmatrix}1&2&3\\3&2&1\end{pmatrix}=x_3+\omega x_2+\omega^2 x_1=\omega^2 q
$$
定义辅助方程

$$(y-p)(y-\omega p)(y-\omega^2p)(y-q)(y-\omega q)(y-\omega^2 q)=0$$

根据复数的 $n$ 次方差公式，它实际上是一个二次方程

$$(y^3-p^3)(y^3-q^3)=0$$

通过韦达定理，将辅助方程的系数唯一分解为 $x_1,x_2,x_3$ 的初等对称多项式

$$
p^3+q^3=(x_1+\omega x_2+\omega^2 x_3)^3+(x_1+\omega^2x_2+\omega x^3)^3\\
=2(x_1+x_2+x_3)^3-9(x_1+x_2+x_3)(x_1x_2+x_1x_3+x_2x_3)+27x_1x_2x_3$$
$$
p^3q^3=(x_1+\omega x_2+\omega^2 x_3)^3(x_1+\omega^2x_2+\omega x^3)^3\\
=((x_1+x_2+x_3)^2-3(x_1x_2+x_1x_3+x_2x_3))^3
$$

代入 $p^3+q^3=2a^3-9ab+27c,p^3q^3=(a^2-3b)^3$，即可解出

$$y=\dfrac{(p^3+q^3)\pm\sqrt{(p^3+q^3)^2-4p^3q^3}}{2}$$

联立线性方程组

$$
\begin{bmatrix}
	1&\omega&\omega^2\\
	1&\omega^2&\omega\\
	1&1&1
\end{bmatrix}

\begin{bmatrix}x_1\\x_2\\ x_3\end{bmatrix}
=\begin{bmatrix}y_1\\y_2\\ a\end{bmatrix}
$$
即可解得 $x_1,x_2,x_3$ 。

### 四次方程解法

对于一元四次方程

$$x^4-ax^3+bx^2-cx+d=0$$

其有四个根 $x_1,x_2,x_3,x_4$，满足韦达定理

$$
\begin{cases}
	x_1+x_2+x_3+x_4=a\\
	x_1x_2+x_1x_3+x_1x_4+x_2x_3+x_2x_4+x_3x_4=b\\
	x_1x_2x_3+x_1x_2x_4+x_1x_3x_4+x_2x_3x_4=c\\
	x_1x_2x_3x_4=d
\end{cases}
$$

设其预解式 $u(\tau)=x_{\tau_1}+ix_{\tau_2}-x_{\tau_3}-ix_{\tau_4}$，

定义预解方程

$$\prod_{\tau}(y-u(\tau))=0$$

它实际上是个一元三次方程，首先根据复数 $n$ 次方差公式，可化简为

$$
(y^4-(x_1-x_2+ix_3-ix_4)^4)(y^4-(x_1-x_2-ix_3+ix_4)^4)\qquad\\
(y^4-(x_1+ix_2-x_3-ix_4)^4)(y^4-(x_1-ix_2-x_3+ix_4)^4)\qquad\\
(y^4-(x_1+ix_2-ix_3-x_4)^4)(y^4-(x_1-ix_2+ix_3-x_4)^4)=0$$

接下来合并相邻两项，可得

